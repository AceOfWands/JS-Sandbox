'use strict';var _createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,'value'in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var Sandbox=function(){function Sandbox(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;_classCallCheck(this,Sandbox),this.globalContext=b||{},this.dom=a||document,this.globalContextProxy=new Proxy(this.globalContext,{get:function(c,d){var e=d in c?c[d]:window[d];return!(d in c)&&e instanceof Function&&(e=function(g){for(var h=[],j=0;j+1<arguments.length;j++)h[j]=arguments[j+1];return g.apply(this,h)}.bind(window,e)),e}.bind(window)}),this.domProxy=new Proxy(this.dom,{get:function(c,d){if('body'==d)return c;var e=d in c?c[d]:document[d];return!(d in c)&&e instanceof Function?e=function(g){for(var h=[],j=0;j+1<arguments.length;j++)h[j]=arguments[j+1];return g.apply(this,h)}.bind(document,e):e instanceof Function&&(e=function(g){for(var h=[],j=0;j+1<arguments.length;j++)h[j]=arguments[j+1];return g.apply(this,h)}.bind(c,e)),e}.bind(document),set:function set(c,d,e){var g=function(){this[d]=e}.bind(c);return g(),!0}})}return _createClass(Sandbox,[{key:'execCode',value:function execCode(code){var newcontext=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.globalContext;(function(window,document,code){var globalScopeInit='';for(var x in window)globalScopeInit+='var '+x+' = window["'+x+'"];';eval(globalScopeInit+code)}).bind(newcontext)(this.globalContextProxy,this.domProxy,code)}},{key:'execFunction',value:function execFunction(func,args){var newcontext=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.globalContext;if(!(func instanceof Function))throw new Exception('Object passed is not a function');return function(window,document,func){var globalScopeInit='';for(var x in window)globalScopeInit+='var '+x+' = window["'+x+'"];';var func_str=func.toString();return func_str.startsWith('function')||(func_str='function '+func_str),eval(globalScopeInit+'('+func_str+'.bind(this)).apply(this,args)')}.bind(newcontext)(this.globalContextProxy,this.domProxy,func,args)}}]),Sandbox}();